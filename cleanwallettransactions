#!/bin/bash
#
# Usage: ./cleanwallettransactions <coinname> <sendbalance (optional) (0|1)>
# Passing a 1 for the third param will send the wallets complete balance to 1 UTXO before cleaning
#
# @author webworker01
#
scriptpath="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
source $scriptpath/main

clean() {
    coin=$1
    if [[ -z "$coin" || "$coin" == "KMD" ]]; then
        acparam=""
    else
        acparam="-ac_name=${coin}"
    fi

    cleanerremoved=$(${komodocli} ${acparam} cleanwallettransactions | jq -r .removed_transactions)
    if (( cleanerremoved > 0 )); then
        log "cleanwallettransactions" "${coin} - Removed ${cleanerremoved} transactions"
    fi
}

clean "KMD"

if (( thirdpartycoins < 1 )); then
    for coins in "${coinlist[@]}"; do
        coin=($coins)
        if [[ ! ${ignoreacs[*]} =~ ${coin[0]} ]]; then
            clean ${coin[0]}
        fi
    done
# else
#     clean "HUSH3"
fi
